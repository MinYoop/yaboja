
DROP TABLE CHATTING;
DROP TABLE MATCHING;


DROP TABLE CINEMA;
CREATE TABLE CINEMA
(
    CINEMASEQ    NUMBER           NOT NULL, 
    CINEMA       VARCHAR2(20)     NULL, 
    LATITUDE     VARCHAR2(200)    NULL, 
    LONGITUDE    VARCHAR2(200)    NULL, 
    CONSTRAINT CINEMA_PK PRIMARY KEY (CINEMASEQ)
);



INSERT INTO CINEMA
VALUES(1,'강남CGV','1','1');
INSERT INTO CINEMA
VALUES(2,'역삼CGV','100','100');
INSERT INTO CINEMA
VALUES(3,'서초CGV','300','300');
INSERT INTO CINEMA
VALUES(4,'화천CGV','333','300');

DROP TABLE USERS;
CREATE TABLE USERS(
    USERSEQ           NUMBER            NOT NULL, 
    USERID            VARCHAR2(200)     NULL, 
    USERPW            VARCHAR2(200)     NULL, 
    USERNAME          VARCHAR2(200)     NULL, 
    USERPROFILE       VARCHAR2(200)     NULL, 
    USERSEX           VARCHAR2(200)     NULL, 
    USERAGE           VARCHAR2(200)     NULL, 
    USERADDRESS       VARCHAR2(200)     NULL, 
    USEREMAIL         VARCHAR2(200)     NULL, 
    USEREMAILHASH     VARCHAR2(2000)    NULL, 
    USEREMAILCHECK    VARCHAR2(200)     NULL, 
    USERTEATHER1      NUMBER            NULL, 
    USERTEATHER2      NUMBER            NULL, 
    USERTEATHER3      NUMBER            NULL, 
    USERGRADE         VARCHAR2(200)     NULL, 
    CONSTRAINT USER_PK PRIMARY KEY (USERSEQ)
);

SELECT * FROM TAB;
SELECT * FROM USERS;
 
ALTER TABLE USERS
    ADD CONSTRAINT FK_USERS_USERTEATHER1_CINEMA_C FOREIGN KEY (USERTEATHER1)
        REFERENCES CINEMA (CINEMASEQ);

ALTER TABLE USERS
    ADD CONSTRAINT FK_USERS_USERTEATHER2_CINEMA_C FOREIGN KEY (USERTEATHER2)
        REFERENCES CINEMA (CINEMASEQ);


ALTER TABLE USERS
    ADD CONSTRAINT FK_USERS_USERTEATHER3_CINEMA_C FOREIGN KEY (USERTEATHER3)
        REFERENCES CINEMA (CINEMASEQ);
SELECT * FROM USERS;



DROP TABLE CHATTING;
CREATE TABLE CHATTING
(
    CHATSEQ        NUMBER            NOT NULL, 
    USERSEQ1       NUMBER            NOT NULL, 
    USERSEQ2       NUMBER            NOT NULL, 
    CHATCONTENT    VARCHAR2(2000)    NOT NULL, 
    CHATTIME       DATE              NOT NULL, 
    CHATREAD       NUMBER            NOT NULL, 
    CONSTRAINT CHATTING_PK PRIMARY KEY (CHATSEQ)
);
ALTER TABLE CHATTING
    ADD CONSTRAINT FK_CHATTING_USERSEQ1_USERS_USE FOREIGN KEY (USERSEQ1)
        REFERENCES USERS (USERSEQ);


ALTER TABLE CHATTING
    ADD CONSTRAINT FK_CHATTING_USERSEQ2_USERS_USE FOREIGN KEY (USERSEQ2)
        REFERENCES USERS (USERSEQ);






DROP TABLE MOVIE;
CREATE TABLE MOVIE
(
    MOVIESEQ      NUMBER            NOT NULL, 
    MOVIETITLE    VARCHAR2(200)     NULL, 
    RATING        VARCHAR2(20)      NULL, 
    GENRE         VARCHAR2(200)     NULL, 
    TIME          VARCHAR2(2000)    NULL, 
    PUPDATE       VARCHAR2(200)     NULL, 
    MOVIESTATE    VARCHAR2(200)     NULL, 
    DIRECTOR      VARCHAR2(200)     NULL, 
    ACTOR         VARCHAR2(2000)    NULL, 
    IMGURL        VARCHAR2(2000)    NULL, 
    CODE          VARCHAR2(200)     NULL, 
    CONSTRAINT MOVIE_PK PRIMARY KEY (MOVIESEQ)
);



DROP SEQUENCE MATCHINGBOARDSQ;
CREATE SEQUENCE MATCHINGBOARDSQ;
DROP TABLE MATCHINGBOARD;
CREATE TABLE MATCHINGBOARD
(
    MATCHINGBOARD           NUMBER           NOT NULL, 
    MOVIESEQ                NUMBER           NOT NULL, 
    USERSEQ                 NUMBER           NOT NULL, 
    MATCHINGBOARDTITLE      VARCHAR2(200)    NOT NULL, 
    MATCHINGBOARDCONTENT    VARCHAR2(200)    NOT NULL, 
    MATCHINGBOARDDATE       DATE             NOT NULL, 
    CINEMASEQ               NUMBER           NOT NULL,
    CONSTRAINT MATCHINGBOARD_PK PRIMARY KEY (MATCHINGBOARD)
);
ALTER TABLE MATCHINGBOARD
    ADD CONSTRAINT FK_MATCHINGBOARD_USERSEQ_USERS FOREIGN KEY (USERSEQ)
        REFERENCES USERS (USERSEQ);

ALTER TABLE MATCHINGBOARD
    ADD CONSTRAINT FK_MATCHINGBOARD_MOVIESEQ_MOVI FOREIGN KEY (MOVIESEQ)
        REFERENCES MOVIE (MOVIESEQ);

ALTER TABLE MATCHINGBOARD
    ADD CONSTRAINT FK_MATCHINGBOARD_CINEMASEQ_CIN FOREIGN KEY (CINEMASEQ)
        REFERENCES CINEMA (CINEMASEQ);
ALTER TABLE MATCHINGBOARD
	ADD CONSTRAINT UQ_MATCHINGBOARD_USERSEQ UNIQUE (USERSEQ);

        
        

	
	
DROP SEQUENCE MATCHINGSEQ;
CREATE SEQUENCE MATCHINGSEQ;
DROP TABLE MATCHING;
CREATE TABLE MATCHING(
    MATCHINGSEQ          NUMBER          NOT NULL, 
    MATCHINGWRITER       NUMBER          NULL, 
    MATCHINGAPPLICANT    NUMBER          NULL, 
    MATCHINGSTATE        VARCHAR2(20)    NULL, 
    WRITERNOTICE         NUMBER    		NULL, 
    APPLICANTNOTICE      NUMBER    		NULL, 
    MATCHINGDATE         DATE            NULL, 
    SELECTEDAPPLICANT    VARCHAR2(20)    NULL, 
    CONSTRAINT MATCHING_PK PRIMARY KEY (MATCHINGSEQ)
);

ALTER TABLE MATCHING
    ADD CONSTRAINT FK_MATCHING_MATCHINGAPPLICANT_ FOREIGN KEY (MATCHINGAPPLICANT)
        REFERENCES USERS (USERSEQ);


ALTER TABLE MATCHING
    ADD CONSTRAINT FK_MATCHING_MATCHINGWRITER_MAT FOREIGN KEY (MATCHINGWRITER)
        REFERENCES MATCHINGBOARD (USERSEQ);

        
        
        
        
        
SELECT * FROM MATCHING;



SELECT * FROM MATCHINGBOARD;








SELECT USERNAME, MATCHINGBOARDTITLE, USERSEX, USERAGE, CINEMA, MOVIETITLE, MATCHINGBOARDDATE
  FROM USERS A, CINEMA B, MOVIE C, MATCHINGBOARD D
  WHERE A.USERSEQ = D.USERSEQ
  		AND B.CINEMASEQ = D.CINEMASEQ
  		AND C.MOVIESEQ = D.MOVIESEQ;
SELECT * FROM MOVIE;
INSERT INTO MOVIE VALUES(1,'태극기 휘날리며','8.8','액션','90분','2019-01-11','상영','김땡땡','김,이,박,배,최,정','URL','CODE');
INSERT INTO MOVIE VALUES(2,'아쿠아맨','6.8','코미디','112분','2019-01-15','상영','김땡똥','김,김,박,배,최,김','URL','CODE');



INSERT INTO USERS VALUES(1,'user1','1234','유저1','유저사진','남','20대후','경기도','aaa@naver.com','hash','1',1,2,3,'일반');
INSERT INTO USERS VALUES(2,'user2','1234','유저2','유저사진2','여','20대초','경기도','aaa@naver.com','hash','1',1,2,3,'일반');
INSERT INTO USERS VALUES(3,'user3','1234','유저삼','유저사진삼','여','20대중','서울','aaa@naver.com','hash','1',1,2,3,'일반');
INSERT INTO USERS VALUES(4,'user4','1234','유저사사','유저사진삼','여','20대중','서울','aaa@naver.com','hash','1',1,2,3,'일반');
INSERT INTO USERS VALUES(5,'user5','1234','유저5','유저사진삼','남','20대중','서울','aaa@naver.com','hash','1',1,2,3,'일반');
INSERT INTO USERS VALUES(6,'user6','1234','유저6','유저사진6','남','20대중','서울','aaa@naver.com','hash','1',1,2,3,'일반');
INSERT INTO USERS VALUES(7,'user7','1234','유저7','유저사진6','남','20대중','서울','aaa@naver.com','hash','1',1,2,3,'일반');
INSERT INTO USERS VALUES(8,'user8','1234','유저8','유저사진8','남','20대중','서울','aaa@naver.com','hash','1',1,2,3,'일반');




INSERT INTO MATCHINGBOARD VALUES(1,2,1,'아쿠아맨 보실분구함','여자환영 신청 고고',SYSDATE,1);
INSERT INTO MATCHINGBOARD VALUES(2,1,2,'태극기휘날리며보실분 장돈건존쟐','남자환영 신청 고고',SYSDATE,2);